{"ast":null,"code":"import axios from 'axios';\nexport const coinGecko = axios.create({\n  baseURL: \"https://api.coingecko.com/api/v3\"\n});\nexport const testing = axios.create({\n  baseURL: \"https://api.coingecko.com/api/v3\",\n  params: {\n    vs_currency: \"usd\",\n    days: \"1\"\n  }\n});\nexport const axiosInstance = axios.create({\n  baseURL: \"http://localhost:8000/api/\",\n  timeout: 5000,\n  headers: {\n    Authorization: localStorage.getItem('access_token') ? 'JWT ' + localStorage.getItem('access_token') : null,\n    'Content-Type': 'application/json',\n    accept: 'application/json'\n  }\n});\naxiosInstance.interceptors.response.use(response => response, error => {\n  const originalRequest = error.config;\n\n  if (error.response.status === 401 && error.response.statusText === \"Unauthorized\") {\n    const refresh_token = localStorage.getItem('refresh_token');\n    return axiosInstance.post('/token/refresh/', {\n      refresh: refresh_token\n    }).then(response => {\n      localStorage.setItem('access_token', response.data.access);\n      localStorage.setItem('refresh_token', response.data.refresh);\n      axiosInstance.defaults.headers['Authorization'] = \"JWT \" + response.data.access;\n      originalRequest.headers['Authorization'] = \"JWT \" + response.data.access;\n      return axiosInstance(originalRequest);\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  return Promise.reject(error);\n});","map":{"version":3,"sources":["/Users/charles/Desktop/Projects/carbcoin/frontend/src/api/axios.js"],"names":["axios","coinGecko","create","baseURL","testing","params","vs_currency","days","axiosInstance","timeout","headers","Authorization","localStorage","getItem","accept","interceptors","response","use","error","originalRequest","config","status","statusText","refresh_token","post","refresh","then","setItem","data","access","defaults","catch","err","console","log","Promise","reject"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,SAAS,GAAGD,KAAK,CAACE,MAAN,CAAa;AAClCC,EAAAA,OAAO,EAAE;AADyB,CAAb,CAAlB;AAIP,OAAO,MAAMC,OAAO,GAAGJ,KAAK,CAACE,MAAN,CAAa;AAChCC,EAAAA,OAAO,EAAE,kCADuB;AAEhCE,EAAAA,MAAM,EAAE;AACJC,IAAAA,WAAW,EAAE,KADT;AAEJC,IAAAA,IAAI,EAAE;AAFF;AAFwB,CAAb,CAAhB;AAQP,OAAO,MAAMC,aAAa,GAAGR,KAAK,CAACE,MAAN,CAAa;AACtCC,EAAAA,OAAO,EAAE,4BAD6B;AAEtCM,EAAAA,OAAO,EAAE,IAF6B;AAGtCC,EAAAA,OAAO,EAAE;AACLC,IAAAA,aAAa,EAAEC,YAAY,CAACC,OAAb,CAAqB,cAArB,IACT,SAASD,YAAY,CAACC,OAAb,CAAqB,cAArB,CADA,GAET,IAHD;AAIL,oBAAgB,kBAJX;AAKLC,IAAAA,MAAM,EAAE;AALH;AAH6B,CAAb,CAAtB;AAYPN,aAAa,CAACO,YAAd,CAA2BC,QAA3B,CAAoCC,GAApC,CACID,QAAQ,IAAIA,QADhB,EAEIE,KAAK,IAAI;AACL,QAAMC,eAAe,GAAGD,KAAK,CAACE,MAA9B;;AAEA,MAAIF,KAAK,CAACF,QAAN,CAAeK,MAAf,KAA0B,GAA1B,IAAiCH,KAAK,CAACF,QAAN,CAAeM,UAAf,KAA8B,cAAnE,EAAmF;AAC/E,UAAMC,aAAa,GAAGX,YAAY,CAACC,OAAb,CAAqB,eAArB,CAAtB;AAEA,WAAOL,aAAa,CACfgB,IADE,CACG,iBADH,EACsB;AAAEC,MAAAA,OAAO,EAAEF;AAAX,KADtB,EAEFG,IAFE,CAEIV,QAAD,IAAc;AAEhBJ,MAAAA,YAAY,CAACe,OAAb,CAAqB,cAArB,EAAqCX,QAAQ,CAACY,IAAT,CAAcC,MAAnD;AACAjB,MAAAA,YAAY,CAACe,OAAb,CAAqB,eAArB,EAAsCX,QAAQ,CAACY,IAAT,CAAcH,OAApD;AAEAjB,MAAAA,aAAa,CAACsB,QAAd,CAAuBpB,OAAvB,CAA+B,eAA/B,IAAkD,SAASM,QAAQ,CAACY,IAAT,CAAcC,MAAzE;AACAV,MAAAA,eAAe,CAACT,OAAhB,CAAwB,eAAxB,IAA2C,SAASM,QAAQ,CAACY,IAAT,CAAcC,MAAlE;AAEA,aAAOrB,aAAa,CAACW,eAAD,CAApB;AACH,KAXE,EAYFY,KAZE,CAYIC,GAAG,IAAI;AACVC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,KAdE,CAAP;AAeH;;AACD,SAAOG,OAAO,CAACC,MAAR,CAAelB,KAAf,CAAP;AACH,CAzBL","sourcesContent":["import axios from 'axios';\n\nexport const coinGecko = axios.create({\n    baseURL: \"https://api.coingecko.com/api/v3\"\n})\n\nexport const testing = axios.create({\n    baseURL: \"https://api.coingecko.com/api/v3\",\n    params: {\n        vs_currency: \"usd\",\n        days: \"1\"\n    }\n})\n\nexport const axiosInstance = axios.create({\n    baseURL: \"http://localhost:8000/api/\",\n    timeout: 5000,\n    headers: {\n        Authorization: localStorage.getItem('access_token')\n            ? 'JWT ' + localStorage.getItem('access_token')\n            : null,\n        'Content-Type': 'application/json',\n        accept: 'application/json'\n    }\n})\n\naxiosInstance.interceptors.response.use(\n    response => response,\n    error => {\n        const originalRequest = error.config;\n\n        if (error.response.status === 401 && error.response.statusText === \"Unauthorized\") {\n            const refresh_token = localStorage.getItem('refresh_token');\n\n            return axiosInstance\n                .post('/token/refresh/', { refresh: refresh_token })\n                .then((response) => {\n\n                    localStorage.setItem('access_token', response.data.access);\n                    localStorage.setItem('refresh_token', response.data.refresh);\n\n                    axiosInstance.defaults.headers['Authorization'] = \"JWT \" + response.data.access;\n                    originalRequest.headers['Authorization'] = \"JWT \" + response.data.access;\n\n                    return axiosInstance(originalRequest);\n                })\n                .catch(err => {\n                    console.log(err)\n                });\n        }\n        return Promise.reject(error)\n    }\n)"]},"metadata":{},"sourceType":"module"}